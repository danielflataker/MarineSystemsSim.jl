<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3-DOF model · MarineSystemsSim.jl</title><meta name="title" content="3-DOF model · MarineSystemsSim.jl"/><meta property="og:title" content="3-DOF model · MarineSystemsSim.jl"/><meta property="twitter:title" content="3-DOF model · MarineSystemsSim.jl"/><meta name="description" content="Documentation for MarineSystemsSim.jl."/><meta property="og:description" content="Documentation for MarineSystemsSim.jl."/><meta property="twitter:description" content="Documentation for MarineSystemsSim.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MarineSystemsSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li class="is-active"><a class="tocitem" href>3-DOF model</a><ul class="internal"><li><a class="tocitem" href="#Equation-form"><span>Equation form</span></a></li><li><a class="tocitem" href="#Parameters-and-mass-matrix"><span>Parameters and mass matrix</span></a></li><li><a class="tocitem" href="#Coriolis-and-centripetal-terms"><span>Coriolis and centripetal terms</span></a></li><li><a class="tocitem" href="#Hydrodynamic-damping"><span>Hydrodynamic damping</span></a></li><li><a class="tocitem" href="#Kinematics"><span>Kinematics</span></a></li><li><a class="tocitem" href="#Full-state-dynamics"><span>Full state dynamics</span></a></li></ul></li><li><a class="tocitem" href="../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>3-DOF model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3-DOF model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/danielflataker/MarineSystemsSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="3-DOF-model"><a class="docs-heading-anchor" href="#3-DOF-model">3-DOF model</a><a id="3-DOF-model-1"></a><a class="docs-heading-anchor-permalink" href="#3-DOF-model" title="Permalink"></a></h1><p>This page summarizes the 3-DOF horizontal-plane model implemented in <code>MarineSystemsSim.jl</code> and how it maps to the main API functions.</p><hr/><h2 id="Equation-form"><a class="docs-heading-anchor" href="#Equation-form">Equation form</a><a id="Equation-form-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-form" title="Permalink"></a></h2><p>We follow the standard Fossen 3-DOF surface craft model in surge–sway–yaw:</p><p class="math-container">\[\mathbf{M} \dot{\boldsymbol{\nu}} +
\mathbf{C}(\boldsymbol{\nu}) \boldsymbol{\nu} +
\mathbf{D}(\boldsymbol{\nu}) \boldsymbol{\nu}
= \boldsymbol{\tau},\]</p><p>with</p><ul><li>body-fixed velocity vector <span>$\boldsymbol{\nu} = [u, v, r]^T$</span>,</li><li>generalized forces/moments <span>$\boldsymbol{\tau} = [\tau_x, \tau_y, \tau_\psi]^T$</span>,</li><li>constant inertia matrix <span>$\mathbf{M} = \mathbf{M}_{RB} + \mathbf{M}_A$</span>,</li><li>Coriolis/centripetal term <span>$\mathbf{C}(\boldsymbol{\nu})\, \boldsymbol{\nu}$</span>,</li><li>linear + quadratic hydrodynamic damping <span>$\mathbf{D}(\boldsymbol{\nu})\, \boldsymbol{\nu}$</span>.</li></ul><p>The kinematics relate body-fixed velocities to Earth-fixed pose <span>$\boldsymbol{\eta} = [x, y, \psi]^T$</span> via</p><p class="math-container">\[\dot{\boldsymbol{\eta}} = \mathbf{R}(\psi)\, \boldsymbol{\nu}.\]</p><p>The full state is</p><p class="math-container">\[\mathbf{X} =
[x, y, \psi, u, v, r]^T.\]</p><hr/><h2 id="Parameters-and-mass-matrix"><a class="docs-heading-anchor" href="#Parameters-and-mass-matrix">Parameters and mass matrix</a><a id="Parameters-and-mass-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters-and-mass-matrix" title="Permalink"></a></h2><p>The rigid-body parameters and hydrodynamic coefficients are stored in <a href="../api/#MarineSystemsSim.RigidBody3DOF"><code>RigidBody3DOF</code></a>, <a href="../api/#MarineSystemsSim.QuadraticDamping3DOF"><code>QuadraticDamping3DOF</code></a>, <a href="../api/#MarineSystemsSim.HydroParams3DOF"><code>HydroParams3DOF</code></a> and <a href="../api/#MarineSystemsSim.VesselParams3DOF"><code>VesselParams3DOF</code></a>. The assembled inertia and damping are cached in <a href="../api/#MarineSystemsSim.Vessel3DOF"><code>Vessel3DOF</code></a>, which is the 3-DOF implementation of <a href="../api/#MarineSystemsSim.AbstractVesselModel"><code>AbstractVesselModel</code></a>. The inertia matrix is constructed by <a href="../api/#MarineSystemsSim.mass_matrix"><code>mass_matrix</code></a> and stored (together with its inverse) inside the <code>Vessel3DOF</code> model.</p><p>You typically build a model via</p><ul><li><code>Vessel3DOF(params)</code> when you already have <code>VesselParams3DOF</code>, or</li><li><a href="../api/#MarineSystemsSim.build_vessel3dof_fossen"><code>build_vessel3dof_fossen</code></a> when starting from Fossen-style manoeuvring derivatives.</li></ul><h3 id="Rigid-body-mass"><a class="docs-heading-anchor" href="#Rigid-body-mass">Rigid-body mass</a><a id="Rigid-body-mass-1"></a><a class="docs-heading-anchor-permalink" href="#Rigid-body-mass" title="Permalink"></a></h3><p>For a surface vessel with mass <code>m</code>, yaw inertia <code>Iz</code> and centre of gravity at <code>(x_G, 0)</code> in the body-fixed frame, the rigid-body mass matrix is</p><p class="math-container">\[\mathbf{M}_{RB} =
\begin{bmatrix}
 m &amp;   0 &amp;   0 \\
 0 &amp;   m &amp; m x_G \\
 0 &amp; m x_G &amp; I_z
\end{bmatrix}.\]</p><p>This is assembled internally from <a href="../api/#MarineSystemsSim.RigidBody3DOF"><code>RigidBody3DOF</code></a> by a private helper and used by <a href="../api/#MarineSystemsSim.mass_matrix"><code>mass_matrix</code></a>.</p><h3 id="Added-mass"><a class="docs-heading-anchor" href="#Added-mass">Added mass</a><a id="Added-mass-1"></a><a class="docs-heading-anchor-permalink" href="#Added-mass" title="Permalink"></a></h3><p>The added-mass matrix <span>$\mathbf{M}_A$</span> is stored directly inside <a href="../api/#MarineSystemsSim.HydroParams3DOF"><code>HydroParams3DOF</code></a>. When constructed via <a href="../api/#MarineSystemsSim.hydroparams_fossen3dof"><code>hydroparams_fossen3dof</code></a> it has the simplified Fossen 3-DOF structure</p><p class="math-container">\[\mathbf{M}_A =
\begin{bmatrix}
- X_{\dot{u}} &amp; 0              &amp; 0 \\
0             &amp; - Y_{\dot{v}}  &amp; - Y_{\dot{r}} \\
0             &amp; - Y_{\dot{r}}  &amp; - N_{\dot{r}}
\end{bmatrix},\]</p><p>where <span>$X_{\dot{u}}, Y_{\dot{v}}, Y_{\dot{r}}, N_{\dot{r}}$</span> are the usual Fossen added-mass derivatives.</p><p>The total inertia matrix is</p><p class="math-container">\[\mathbf{M} = \mathbf{M}_{RB} + \mathbf{M}_A,\]</p><p>and is constructed by <a href="../api/#MarineSystemsSim.mass_matrix"><code>mass_matrix</code></a> and cached in <a href="../api/#MarineSystemsSim.Vessel3DOF"><code>Vessel3DOF</code></a>.</p><hr/><h2 id="Coriolis-and-centripetal-terms"><a class="docs-heading-anchor" href="#Coriolis-and-centripetal-terms">Coriolis and centripetal terms</a><a id="Coriolis-and-centripetal-terms-1"></a><a class="docs-heading-anchor-permalink" href="#Coriolis-and-centripetal-terms" title="Permalink"></a></h2><p>The Coriolis/centripetal contribution is modeled as</p><p class="math-container">\[\mathbf{C}(\boldsymbol{\nu}) \, \boldsymbol{\nu}
=
\bigl(
\mathbf{C}_{RB}(\boldsymbol{\nu})
+
\mathbf{C}_A(\boldsymbol{\nu})
\bigr)\, \boldsymbol{\nu},\]</p><p>with rigid-body and added-mass parts following Fossen’s 3-DOF expressions. Both matrices are constructed internally from the parameters and satisfy</p><p class="math-container">\[\boldsymbol{\nu}^T \mathbf{C}_{RB}(\boldsymbol{\nu}) \, \boldsymbol{\nu}
= 0,
\qquad
\boldsymbol{\nu}^T \mathbf{C}_A(\boldsymbol{\nu}) \, \boldsymbol{\nu}
= 0,\]</p><p>so that they do not create or dissipate energy.</p><p>The product <span>$\mathbf{C}(\boldsymbol{\nu}) , \boldsymbol{\nu}$</span> is provided by <a href="../api/#MarineSystemsSim.coriolis_forces"><code>coriolis_forces</code></a>.</p><hr/><h2 id="Hydrodynamic-damping"><a class="docs-heading-anchor" href="#Hydrodynamic-damping">Hydrodynamic damping</a><a id="Hydrodynamic-damping-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrodynamic-damping" title="Permalink"></a></h2><p>Hydrodynamic damping is represented as a linear part plus a diagonal quadratic part:</p><p class="math-container">\[\mathbf{D}(\boldsymbol{\nu}) \, \boldsymbol{\nu}
=
\mathbf{D}_{\text{lin}} \boldsymbol{\nu}
+
\mathbf{D}_{\text{n}}(\boldsymbol{\nu}) \, \boldsymbol{\nu}.\]</p><h3 id="Linear-damping"><a class="docs-heading-anchor" href="#Linear-damping">Linear damping</a><a id="Linear-damping-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-damping" title="Permalink"></a></h3><p>The physical linear damping matrix (\mathbf{D}_{\text{lin}}) is stored directly in <a href="../api/#MarineSystemsSim.HydroParams3DOF"><code>HydroParams3DOF</code></a> and cached in <a href="../api/#MarineSystemsSim.Vessel3DOF"><code>Vessel3DOF</code></a>. It is used exactly as it appears in the equations:</p><p class="math-container">\[\mathbf{D}_{\text{lin}} \boldsymbol{\nu}.\]</p><p>When <a href="../api/#MarineSystemsSim.hydroparams_fossen3dof"><code>hydroparams_fossen3dof</code></a> is used, (\mathbf{D}<em>{\text{lin}}) is constructed from the Fossen derivatives X</em>u, X<em>v, X</em>r, \dots$ as</p><p class="math-container">\[\mathbf{D}_{\text{lin}} =
- \begin{bmatrix}
X_u &amp; X_v &amp; X_r \\
Y_u &amp; Y_v &amp; Y_r \\
N_u &amp; N_v &amp; N_r
\end{bmatrix}.\]</p><p>Here the derivatives are given in Fossen’s convention (typically non-positive for drag), while <span>$\mathbf{D}_{\text{lin}}$</span> itself is a physical damping matrix that appears in the equation <span>$\mathbf{D}(\boldsymbol{\nu})\, \boldsymbol{\nu}$</span>.</p><h3 id="Quadratic-damping"><a class="docs-heading-anchor" href="#Quadratic-damping">Quadratic damping</a><a id="Quadratic-damping-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-damping" title="Permalink"></a></h3><p>The quadratic damping coefficients are stored in <a href="../api/#MarineSystemsSim.QuadraticDamping3DOF"><code>QuadraticDamping3DOF</code></a>, holding the entries <span>$X_{uu}, Y_{vv}, N_{rr}$</span>. For a given velocity <span>$\boldsymbol{\nu} = [u, v, r]^T$</span>, the diagonal quadratic matrix is</p><p class="math-container">\[\mathbf{D}_{\text{n}}(\boldsymbol{\nu})
=
- \operatorname{diag}\bigl(
X_{uu} |u|,
Y_{vv} |v|,
N_{rr} |r|
\bigr),\]</p><p>so that the total damping becomes</p><p class="math-container">\[\mathbf{D}(\boldsymbol{\nu}) =
\mathbf{D}_{\text{lin}} + \mathbf{D}_{\text{n}}(\boldsymbol{\nu}).\]</p><p>The product <span>$\mathbf{D}(\boldsymbol{\nu}) \, \boldsymbol{\nu}$</span> is computed by <a href="../api/#MarineSystemsSim.damping_forces"><code>damping_forces</code></a>.</p><hr/><h2 id="Kinematics"><a class="docs-heading-anchor" href="#Kinematics">Kinematics</a><a id="Kinematics-1"></a><a class="docs-heading-anchor-permalink" href="#Kinematics" title="Permalink"></a></h2><p>The 3-DOF kinematics in the horizontal plane are</p><p class="math-container">\[\dot{\boldsymbol{\eta}} = \mathbf{R}(\psi)\, \boldsymbol{\nu},\]</p><p>where <span>$\mathbf{R}(\psi)$</span> is the rotation from body-fixed to Earth-fixed frame.</p><p><a href="../api/#MarineSystemsSim.rotation_body_to_earth"><code>rotation_body_to_earth</code></a> returns the <span>$3 \times 3$</span> rotation matrix <span>$\mathbf{R}(\psi)$</span>, and <a href="../api/#MarineSystemsSim.kinematics"><code>kinematics</code></a> computes <span>$\dot{\boldsymbol{\eta}}$</span> for a given pose and velocity.</p><ul><li><code>rotation_body_to_earth(ψ)</code> returns the <code>3×3</code> rotation matrix <span>$\mathbf{R}(\psi)$</span>,</li><li><code>kinematics(η, ν)</code> computes <span>$\dot{\boldsymbol{\eta}}$</span> for a given pose and velocity.</li></ul><hr/><h2 id="Full-state-dynamics"><a class="docs-heading-anchor" href="#Full-state-dynamics">Full state dynamics</a><a id="Full-state-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Full-state-dynamics" title="Permalink"></a></h2><p>Combining kinematics and dynamics, the full state derivative is</p><p class="math-container">\[\dot{\mathbf{X}} =
[\dot{x}, \dot{y}, \dot{\psi}, \dot{u}, \dot{v}, \dot{r}]^T,\]</p><p>where</p><p class="math-container">\[\dot{\boldsymbol{\eta}} =
\mathbf{R}(\psi)\, \boldsymbol{\nu},
\qquad
\dot{\boldsymbol{\nu}} =
\mathbf{M}^{-1} \bigl(
\boldsymbol{\tau}
- \mathbf{C}(\boldsymbol{\nu}) \boldsymbol{\nu}
- \mathbf{D}(\boldsymbol{\nu}) \boldsymbol{\nu}
\bigr).\]</p><p>The body dynamics are computed by <a href="../api/#MarineSystemsSim.body_dynamics"><code>body_dynamics</code></a>, and the full state derivative by <a href="../api/#MarineSystemsSim.vessel_dynamics"><code>vessel_dynamics</code></a>, which splits the state into <span>$\eta$</span> and <span>$\nu$</span>, applies the kinematics and dynamics, and returns the combined 6-element derivative.</p><ul><li><a href="../api/#MarineSystemsSim.body_dynamics"><code>body_dynamics</code></a> computes (\dot{\boldsymbol{\nu}}),</li><li><a href="../api/#MarineSystemsSim.vessel_dynamics"><code>vessel_dynamics</code></a> splits <code>X</code> into <code>(η, ν)</code>, computes <code>η̇</code> and <code>ν̇</code>, and returns the full 6-element state derivative.</li></ul><p>These functions are designed to be used directly with differential equation solvers and automatic differentiation, with <code>Vessel3DOF</code> as the concrete 3-DOF model type.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting started</a><a class="docs-footer-nextpage" href="../api/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Saturday 22 November 2025 20:38">Saturday 22 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
